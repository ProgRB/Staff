select tab1.*,(tab1.s116+tab1.s39+tab1.s91+tab1.s139) as unprm, (tab1.alll+tab1.s116+tab1.s39+tab1.s91+tab1.s139) as total from 
(select rd1.reason_name, 
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and degree_id in (01,08) and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or 
(trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy'))
)) as main_emp,
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and degree_id in (05,09,07,13,02) and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))  ) as help_emp,
(select count(tr_num_order) from {2}.transfer tr, {2}.position pos, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and pos.pos_id=tr.pos_id and ((substr(pos.code_pos,1,1)=9 and (select substr(pord1.code_pos,1,1) from {2}.position pord1 where pord1.pos_id = pos.from_pos_id)=2) or (substr(pos.code_pos,1,1)=2)) and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as boss,
(select count(tr_num_order) from {2}.transfer tr, {2}.position pos, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and pos.pos_id=tr.pos_id and ((substr(pos.code_pos,1,1)=9 and (select substr(pord1.code_pos,1,1) from {2}.position pord1 where pord1.pos_id = pos.from_pos_id)=3) or (substr(pos.code_pos,1,1)=3)) and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as spec,
(select count(tr_num_order) from {2}.transfer tr, {2}.position pos, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and pos.pos_id=tr.pos_id and ((substr(pos.code_pos,1,1)=9 and (select substr(pord1.code_pos,1,1) from {2}.position pord1 where pord1.pos_id = pos.from_pos_id) not in (1,2,3) ) or (substr(pos.code_pos,1,1) not in (1,2,3))) and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as other,
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and degree_id=06 and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as pupil,
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as alll,
(select count(tr_num_order) from {2}.transfer tr, {2}.emp em, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and (trunc(MONTHS_BETWEEN(tr.date_transfer, em.emp_birth_date)/12))<18 and tr.per_num=em.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as bef_18,
(select count(tr_num_order) from {2}.transfer tr, {2}.emp em, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and (trunc(MONTHS_BETWEEN(tr.date_transfer, em.emp_birth_date)/12)) between 18 and 30 and tr.per_num=em.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as p18_30,
(select count(tr_num_order) from {2}.transfer tr, {2}.emp em, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and (trunc(MONTHS_BETWEEN(tr.date_transfer, em.emp_birth_date)/12)) between 31 and 40 and tr.per_num=em.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as p31_40,
(select count(tr_num_order) from {2}.transfer tr, {2}.emp em, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and (trunc(MONTHS_BETWEEN(tr.date_transfer, em.emp_birth_date)/12)) between 41 and 50 and tr.per_num=em.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as p41_50,
(select count(tr_num_order) from {2}.transfer tr, {2}.emp em, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and (trunc(MONTHS_BETWEEN(tr.date_transfer, em.emp_birth_date)/12)) between 51 and 60 and tr.per_num=em.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as p51_60,
(select count(tr_num_order) from {2}.transfer tr, {2}.emp em, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and (trunc(MONTHS_BETWEEN(tr.date_transfer, em.emp_birth_date)/12))>60 and tr.per_num=em.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as af_60,
(select count(tr_num_order) from {2}.transfer tr, {2}.edu ed, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and ed.type_edu_id in (0,1,2) and ed.edu_id = (select max(edu_id) from {2}.edu ed where per_num = tr.per_num and type_edu_id = (select max(type_edu_id) from {2}.edu ed where ed.per_num = tr.per_num and type_edu_id !=8)) and tr.per_num=ed.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as nf_mid,
(select count(tr_num_order) from {2}.transfer tr, {2}.edu ed, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and ed.type_edu_id in (3,9,12) and ed.edu_id = (select max(edu_id) from {2}.edu ed where per_num = tr.per_num and type_edu_id = (select max(type_edu_id) from {2}.edu ed where ed.per_num = tr.per_num and type_edu_id !=8)) and tr.per_num=ed.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as middl,
(select count(tr_num_order) from {2}.transfer tr, {2}.edu ed, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and ed.type_edu_id in (4,11) and ed.edu_id = (select max(edu_id) from {2}.edu ed where per_num = tr.per_num and type_edu_id = (select max(type_edu_id) from {2}.edu ed where ed.per_num = tr.per_num and type_edu_id !=8)) and tr.per_num=ed.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as mid_tech,
(select count(tr_num_order) from {2}.transfer tr, {2}.edu ed, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and ed.type_edu_id in (6,7) and ed.edu_id = (select max(edu_id) from {2}.edu ed where per_num = tr.per_num and type_edu_id = (select max(type_edu_id) from {2}.edu ed where ed.per_num = tr.per_num and type_edu_id !=8)) and tr.per_num=ed.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as h_sch,
(select count(tr_num_order) from {2}.transfer tr, {2}.edu ed, {2}.subdiv sub where degree_id!=13 and sub.code_subdiv not in  (139,116,39,91) and tr.subdiv_id=sub.subdiv_id and tr.reason_id=rd1.reason_id and ed.type_edu_id in (5,10) and ed.edu_id = (select max(edu_id) from {2}.edu ed where per_num = tr.per_num and type_edu_id = (select max(type_edu_id) from {2}.edu ed where ed.per_num = tr.per_num and type_edu_id !=8)) and tr.per_num=ed.per_num and type_transfer_id=3 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as mid_spec,
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub, {2}.per_data pd where tr.reason_id=rd1.reason_id and tr.subdiv_id=sub.subdiv_id and tr.per_num=pd.per_num and pd.retirer_sign!=1 and type_transfer_id=3 and sub.code_subdiv ='116' and tr.sign_comb!=1 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as s116,
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub, {2}.per_data pd where tr.reason_id=rd1.reason_id and tr.subdiv_id=sub.subdiv_id and tr.per_num=pd.per_num and pd.retirer_sign!=1 and type_transfer_id=3 and sub.code_subdiv ='039' and tr.sign_comb!=1 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as s39,
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub, {2}.per_data pd where tr.reason_id=rd1.reason_id and tr.subdiv_id=sub.subdiv_id and tr.per_num=pd.per_num and pd.retirer_sign!=1 and type_transfer_id=3 and sub.code_subdiv ='091' and tr.sign_comb!=1 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as s91,
(select count(tr_num_order) from {2}.transfer tr, {2}.subdiv sub, {2}.per_data pd where tr.reason_id=rd1.reason_id and tr.subdiv_id=sub.subdiv_id and tr.per_num=pd.per_num and pd.retirer_sign!=1 and type_transfer_id=3 and sub.code_subdiv ='139' and tr.sign_comb!=1 and (trunc(date_transfer) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy') or (trunc(date_transfer)<to_date('{0}', 'dd.mm.yyyy') and trunc(df_book_dismiss) between to_date('{0}', 'dd.mm.yyyy') and to_date('{1}', 'dd.mm.yyyy')))) as s139
from {2}.reason_dismiss rd1 where reason_id in (1,2,3,4,17,18,19,20,21,28,29,30,31,32,33,34,36,39,40,41,43,44) order by reason_name) tab1 where (tab1.alll+tab1.s116+tab1.s39+tab1.s91+tab1.s139)!=0